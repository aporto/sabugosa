<head>
 <style>
 body { color: #00bb00; background-color:#001100;	}
 </style>
 </head>
<pre style="font: 10px/5px monospace;">                                                                                                                                                                                                        
<font></font><font color="#005500">       //turns off console messages - default is to print messages        static void setVerbose(bool _verbose);        //Functions in
 </font><font color="#00bb00">r</font><font color="#005500">ough order they should be used.        static int listDevices(bool silent = false);        //needs to be called after listDevices </font><font color="#00bb00">-</font><font color="#005500"> 
otherwise returns NULL        static char * getDeviceName(int deviceID);        //choose to use callback based capture - or single thr
eaded        void setUseCallback(bool useCallback);        //call before setupDevice        //directshow will try and get the closest 
possible framerate to what is requested        void setIdealFramerate(int deviceID, int idealFramerate);        //some devices will st
op delivering frames after a while - this method gives you the option to try and reconnect        //to a device if videoInput detects 
that a device has stopped delivering frames.        //you MUST CALL isFrameNew every app loop for this to have any effect        void 
setAutoReconnectOnFreeze(int deviceNumber, bool doReconnect, int numMissedFramesBeforeReconnect);        //Choose one of these five to
 setup your device        bool setupDevice(int deviceID);      </font><font color="#00bb00">  bool s</font><font color="#005500">etupDevice(int deviceID, int w, int h);        bool setupDevice
Fourcc(int deviceID, int w, int h,int fourcc);        //These t</font><font color="#00bb00">wo are o</font><font color="#005500">nly for capture cards        //USB and Firewire cameras souldn'
t specify connection        bool setupDevice(int </font><font color="#00bb00">dev</font><font color="#005500">iceID, int </font><font color="#00bb00">co</font><font color="#005500">nnec</font><font color="#00bb00">ti</font><font color="#005500">on);       </font><font color="#00bb00"> bo</font><font color="#005500">ol setupDevice(int deviceID, int w, int h, int co
nnection);        bool setFourcc(int deviceNum</font><font color="#00bb00">ber, in</font><font color="#005500">t fourcc)</font><font color="#00bb00">;  </font><font color="#005500">    </font><font color="#00bb00">  /</font><font color="#005500">/If you n</font><font color="#00bb00">eed to </font><font color="#005500">you can set your NTSC/PAL/SECAM        //prefe
rence here. if it is available it will be use</font><font color="#00bb00">d.   </font><font color="#005500"> </font><font color="#00bb00">   </font><font color="#005500"> //see #</font><font color="#00bb00">de</font><font color="#005500">fines </font><font color="#00bb00">ab</font><font color="#005500">ove for </font><font color="#00bb00">ava</font><font color="#005500">i</font><font color="#00bb00">lable</font><font color="#005500"> formats - eg VI_NTSC_M or VI_PAL_B        //
should be called after setupDevice        //c</font><font color="#00bb00">an</font><font color="#005500"> be c</font><font color="#00bb00">al</font><font color="#005500">led mult</font><font color="#00bb00">ip</font><font color="#005500">le tim</font><font color="#00bb00">es</font><font color="#005500">        </font><font color="#00bb00">bo</font><font color="#005500">ol se</font><font color="#00bb00">tF</font><font color="#005500">ormat(int deviceNumber, int format);        /
/Tells you when a new frame has arrived - you</font><font color="#00bb00"> s</font><font color="#005500">hould</font><font color="#00bb00"> ca</font><font color="#005500">ll this</font><font color="#00bb00"> i</font><font color="#005500">f you </font><font color="#00bb00">ha</font><font color="#005500">ve spec</font><font color="#00bb00">ifi</font><font color="#005500">ed se</font><font color="#00bb00">tA</font><font color="#005500">utoReconnectOnFreeze to true        bool isFr
ameNew(int deviceID);        bool isDeviceSet</font><font color="#00bb00">up</font><font color="#005500">(int d</font><font color="#00bb00">evi</font><font color="#005500">ceID);</font><font color="#00bb00">  </font><font color="#005500">      </font><font color="#00bb00">//</font><font color="#005500">Return</font><font color="#00bb00">s t</font><font color="#005500">he pix</font><font color="#00bb00">el</font><font color="#005500">s - flipRedAndBlue toggles RGB/BGR flipping -
 and you can flip the image too        unsign</font><font color="#00bb00">ed</font><font color="#005500"> char *</font><font color="#00bb00"> g</font><font color="#005500">etPixe</font><font color="#00bb00">ls</font><font color="#005500">(int d</font><font color="#00bb00">ev</font><font color="#005500">iceID,</font><font color="#00bb00"> b</font><font color="#005500">ool fli</font><font color="#00bb00">pR</font><font color="#005500">edAndBlue = true, bool flipImage = false);   
     //Or pass in a buffer for get</font><font color="#00bb00">P</font><font color="#005500">ixels to f</font><font color="#00bb00">il</font><font color="#005500">l retur</font><font color="#00bb00">ns</font><font color="#005500"> true </font><font color="#00bb00">if</font><font color="#005500"> succe</font><font color="#00bb00">ss</font><font color="#005500">ful.  </font><font color="#00bb00">  </font><font color="#005500">    boo</font><font color="#00bb00">l </font><font color="#005500">getPixels(</font><font color="#00bb00">i</font><font color="#005500">nt id, unsigned char * pixels, boo
l flipRedAndBlue = true, bool fli</font><font color="#00bb00">pIm</font><font color="#005500">age = fal</font><font color="#00bb00">se)</font><font color="#005500">;     </font><font color="#00bb00">  </font><font color="#005500"> //Lau</font><font color="#00bb00">nc</font><font color="#005500">hes a </font><font color="#00bb00">po</font><font color="#005500">p up s</font><font color="#00bb00">et</font><font color="#005500">tings </font><font color="#00bb00">win</font><font color="#005500">dow      </font><font color="#00bb00">  /</font><font color="#005500">/For some reason in GLUT you have
 to call it twice each time.   </font><font color="#00bb00">     v</font><font color="#005500">oid showS</font><font color="#00bb00">et</font><font color="#005500">tingsW</font><font color="#00bb00">ind</font><font color="#005500">o</font><font color="#00bb00">w(int </font><font color="#005500">device</font><font color="#00bb00">ID);  </font><font color="#005500"> </font><font color="#00bb00">   </font><font color="#005500">  //Ma</font><font color="#00bb00">nu</font><font color="#005500">al contro</font><font color="#00bb00">l over</font><font color="#005500"> settings thanks.....        //
These are experimental for now</font><font color="#00bb00">.   </font><font color="#005500"> </font><font color="#00bb00">    </font><font color="#005500">bool se</font><font color="#00bb00">tV</font><font color="#005500">ideoSet</font><font color="#00bb00">tingFilte</font><font color="#005500">r(int </font><font color="#00bb00">deviceID,</font><font color="#005500"> long P</font><font color="#00bb00">ro</font><font color="#005500">perty, </font><font color="#00bb00">long</font><font color="#005500"> </font><font color="#00bb00">lVal</font><font color="#005500">ue, long Flags = 0, bool useDe
faultValue = false);        b</font><font color="#00bb00">ool</font><font color="#005500"> set</font><font color="#00bb00">Vide</font><font color="#005500">oSetti</font><font color="#00bb00">ngF</font><font color="#005500">ilterP</font><font color="#00bb00">ct(i</font><font color="#005500">nt deviceID, lon</font><font color="#00bb00">g Pr</font><font color="#005500">operty</font><font color="#00bb00">, f</font><font color="#005500">loat p</font><font color="#00bb00">ctVa</font><font color="#005500">lue,</font><font color="#00bb00"> lo</font><font color="#005500">ng Flags = 0);        bool ge
tVideoSettingFilter(int devic</font><font color="#00bb00">eID</font><font color="#005500">, long</font><font color="#00bb00"> P</font><font color="#005500">roperty</font><font color="#00bb00">, </font><font color="#005500">long &min, long &max, long &Stepping</font><font color="#00bb00">De</font><font color="#005500">lta, lo</font><font color="#00bb00">ng</font><font color="#005500"> &curr</font><font color="#00bb00">ent</font><font color="#005500">Value, long &flags, long &def
aultValue);        bool setVid</font><font color="#00bb00">eo</font><font color="#005500">Setting</font><font color="#00bb00">Ca</font><font color="#005500">mera(</font><font color="#00bb00">int </font><font color="#005500">deviceID, long Property, long lVal</font><font color="#00bb00">ue, </font><font color="#005500">long </font><font color="#00bb00">Fl</font><font color="#005500">ags = 0</font><font color="#00bb00">, </font><font color="#005500">bool useDefaultValue = false);
        bool setVideoSettingCa</font><font color="#00bb00">me</font><font color="#005500">raPct(i</font><font color="#00bb00">nt </font><font color="#005500">de</font><font color="#00bb00">vice</font><font color="#005500">ID, long Property, float pctValue, lon</font><font color="#00bb00">g Fl</font><font color="#005500">ag</font><font color="#00bb00">s =</font><font color="#005500"> 0);   </font><font color="#00bb00">  </font><font color="#005500">   bool getVideoSettingCamera(
int deviceID, long Property, l</font><font color="#00bb00">ong</font><font color="#005500"> &min, </font><font color="#00bb00">long &</font><font color="#005500">max, long &SteppingDelta, long &currentVal</font><font color="#00bb00">ue, lo</font><font color="#005500">ng &fla</font><font color="#00bb00">gs,</font><font color="#005500"> long &defaultValue);        /
/bool setVideoSettingCam(int de</font><font color="#00bb00">vi</font><font color="#005500">ceID, l</font><font color="#00bb00">ong </font><font color="#005500">Property, long lValue, long Flags = NULL, bool</font><font color="#00bb00"> use</font><font color="#005500">Default</font><font color="#00bb00">Va</font><font color="#005500">lue = false);        //get widt
h, height and number of pixels </font><font color="#00bb00">   </font><font color="#005500">    int</font><font color="#00bb00"> </font><font color="#005500"> getWidth(int deviceID);        int  getHeight(int</font><font color="#00bb00"> </font><font color="#005500">deviceI</font><font color="#00bb00">D);</font><font color="#005500">        int  getSize(int device
ID);        int  getFourcc(int d</font><font color="#00bb00">evi</font><font color="#005500">ceID);        double getFPS(int deviceID);        //completely s</font><font color="#00bb00">top</font><font color="#005500">s and frees a device        void
 stopDevice(int deviceID);       </font><font color="#00bb00"> /</font><font color="#005500">/as above but then sets it up with same settings        bool res</font><font color="#00bb00">ta</font><font color="#005500">rtDevice(int deviceID);        //
number of devices av</font><font color="#00bb00">ai</font><font color="#005500">lable      </font><font color="#00bb00">  i</font><font color="#005500">nt  devicesFound;        // mapping from OpenCV CV_CAP_PROP to</font><font color="#00bb00"> vi</font><font color="#005500">deoinput/ds</font><font color="#00bb00">ho</font><font color="#005500">w properties        
int getVideoPropert</font><font color="#00bb00">yFromC</font><font color="#005500">V(int cv_</font><font color="#00bb00">pro</font><font color="#005500">perty);        int getCameraPropertyFromCV(int cv_property);</font><font color="#00bb00">   </font><font color="#005500"> private:</font><font color="#00bb00">      </font><font color="#005500">  void setPhyCon(in
t deviceID, int co</font><font color="#00bb00">nn);     </font><font color="#005500">   voi</font><font color="#00bb00">d s</font><font color="#005500">etAttemptCaptureSize(int deviceID, int w, int h,GUID mediaType</font><font color="#00bb00">=ME</font><font color="#005500">DIASUB</font><font color="#00bb00">TYPE_RGB2</font><font color="#005500">4);        bool se
tup(int deviceID);</font><font color="#00bb00">  </font><font color="#005500">    </font><font color="#00bb00">  vo</font><font color="#005500">id p</font><font color="#00bb00">roc</font><font color="#005500">essPixels(unsigned char * src, unsigned char * dst, int width, i</font><font color="#00bb00">nt </font><font color="#005500">heig</font><font color="#00bb00">ht, </font><font color="#005500">bool</font><font color="#00bb00"> b</font><font color="#005500">RGB, bool bFlip); 
       int  start</font><font color="#00bb00">(i</font><font color="#005500">nt devi</font><font color="#00bb00">ceID</font><font color="#005500">,</font><font color="#00bb00"> vi</font><font color="#005500">deoDevice * VD);        int  getDeviceCount();        void</font><font color="#00bb00"> g</font><font color="#005500">etMedi</font><font color="#00bb00">aSu</font><font color="#005500">b</font><font color="#00bb00">type</font><font color="#005500">AsStrin</font><font color="#00bb00">g(</font><font color="#005500">GUID type, char *
 typeAsString); </font><font color="#00bb00">   </font><font color="#005500">    GUID</font><font color="#00bb00"> *getM</font><font color="#005500">ediaSubtypeFromFourcc(int fourcc);        int    getFou</font><font color="#00bb00">rccFro</font><font color="#005500">mMediaS</font><font color="#00bb00">ubtype</font><font color="#005500">(GUID ty</font><font color="#00bb00">pe)</font><font color="#005500">;        void ge
tVideoPropertyAsS</font><font color="#00bb00">tri</font><font color="#005500">ng(int pr</font><font color="#00bb00">op,</font><font color="#005500"> char * propertyAsString);      </font><font color="#00bb00">  voi</font><font color="#005500">d getCameraProper</font><font color="#00bb00">tyAsStr</font><font color="#005500">ing(int p</font><font color="#00bb00">rop</font><font color="#005500">, char * </font><font color="#00bb00">pro</font><font color="#005500">pertyAsString);  
      HRESULT getD</font><font color="#00bb00">evi</font><font color="#005500">ce(IBaseF</font><font color="#00bb00">i</font><font color="#005500">lter</font><font color="#00bb00"> </font><font color="#005500">**pSrcFilter, int deviceID, </font><font color="#00bb00">WCHAR</font><font color="#005500"> * wDeviceName, </font><font color="#00bb00">char * </font><font color="#005500">nDeviceName</font><font color="#00bb00">)</font><font color="#005500">;        </font><font color="#00bb00">sta</font><font color="#005500">tic HRESULT ShowFi
lterPropertyPages(I</font><font color="#00bb00">Ba</font><font color="#005500">seFilter *pFil</font><font color="#00bb00">te</font><font color="#005500">r);        static HRESULT </font><font color="#00bb00">ShowStr</font><font color="#005500">eamPropertyPag</font><font color="#00bb00">es(IAMS</font><font color="#005500">treamConfig  *pStream)</font><font color="#00bb00">; </font><font color="#005500">       HRESULT Save
GraphFile(IGraphBui</font><font color="#00bb00">lde</font><font color="#005500">r *pGraph, WCH</font><font color="#00bb00">AR</font><font color="#005500"> *wszPath);        HRESU</font><font color="#00bb00">LT route</font><font color="#005500">Crossbar(ICap</font><font color="#00bb00">tureGra</font><font color="#005500">phBuilder2 **ppBuild, </font><font color="#00bb00">IBa</font><font color="#005500">seFilter **pVidInFi
lter, int conType, G</font><font color="#00bb00">UID </font><font color="#005500">captureMode);</font><font color="#00bb00">  </font><font color="#005500">      //don't touch    </font><font color="#00bb00">    stati</font><font color="#005500">c bool comIn</font><font color="#00bb00">it(); </font><font color="#005500">       sta</font><font color="#00bb00">t</font><font color="#005500">ic bool co</font><font color="#00bb00">mUnI</font><font color="#005500">nit();        int  c
onnection;        int </font><font color="#00bb00"> cal</font><font color="#005500">lbackSetCoun</font><font color="#00bb00">t;</font><font color="#005500">        bool bCallbac</font><font color="#00bb00">k;        </font><font color="#005500">GUID CAPTUR</font><font color="#00bb00">E_MODE; </font><font color="#005500">       /</font><font color="#00bb00">/E</font><font color="#005500">xtra vid</font><font color="#00bb00">eo s</font><font color="#005500">ubtypes        GUID ME
DIASUBTYPE_Y800;       </font><font color="#00bb00"> GUI</font><font color="#005500">D MEDIASUBTY</font><font color="#00bb00">PE</font><font color="#005500">_Y</font><font color="#00bb00">8</font><font color="#005500">;        GUID ME</font><font color="#00bb00">DIASUBTYPE_G</font><font color="#005500">REY;      </font><font color="#00bb00">  videoDe</font><font color="#005500">vice *</font><font color="#00bb00"> VD</font><font color="#005500">List[VI</font><font color="#00bb00">_MAX</font><font color="#005500">_CAMERAS];        GUID 
mediaSubtypes[VI_NUM_TYP</font><font color="#00bb00">ES</font><font color="#005500">];        long</font><font color="#00bb00"> form</font><font color="#005500">atTypes[VI_NUM_</font><font color="#00bb00">FORMATS];   </font><font color="#005500">     stati</font><font color="#00bb00">c void __c</font><font color="#005500">decl</font><font color="#00bb00"> bas</font><font color="#005500">icThread</font><font color="#00bb00">(v</font><font color="#005500">oid * objPtr);        st
atic char deviceNames[VI</font><font color="#00bb00">_M</font><font color="#005500">AX_CAMERAS][255</font><font color="#00bb00">];};/</font><font color="#005500">//////////////</font><font color="#00bb00">////////////</font><font color="#005500">  HANDY FU</font><font color="#00bb00">NCTIONS  //</font><font color="#005500">//</font><font color="#00bb00">/////</font><font color="#005500">////////</font><font color="#00bb00">//</font><font color="#005500">//////////static void My
FreeMediaType(AM_MEDIA_</font><font color="#00bb00">TY</font><font color="#005500">PE& mt){    if </font><font color="#00bb00">(mt.cbF</font><font color="#005500">ormat != 0)  </font><font color="#00bb00">  {        C</font><font color="#005500">oTaskMemFr</font><font color="#00bb00">ee((PVOID)mt.pbFor</font><font color="#005500">mat);    </font><font color="#00bb00">  </font><font color="#005500">  mt.cbFormat = 0;     
   mt.pbFor</font><font color="#00bb00">mat = N</font><font color="#005500">ULL; </font><font color="#00bb00">  </font><font color="#005500"> }    if (mt.pU</font><font color="#00bb00">nk != NU</font><font color="#005500">LL)    {   </font><font color="#00bb00">     // Uneces</font><font color="#005500">sary becau</font><font color="#00bb00">se pUnk should n</font><font color="#005500">ot be used</font><font color="#00bb00">, </font><font color="#005500">but s</font><font color="#00bb00">afest. </font><font color="#005500">       mt.p
Unk->Relea</font><font color="#00bb00">se();      </font><font color="#005500"> </font><font color="#00bb00"> m</font><font color="#005500">t.pUnk = NULL;   </font><font color="#00bb00"> }}sta</font><font color="#005500">tic void MyD</font><font color="#00bb00">eleteMediaType(</font><font color="#005500">AM_MEDIA</font><font color="#00bb00">_TYPE *pmt){    i</font><font color="#005500">f (pmt != N</font><font color="#00bb00">UL</font><font color="#005500">L</font><font color="#00bb00">)    {     </font><font color="#005500">   MyFreeM
ediaType(*</font><font color="#00bb00">pm</font><font color="#005500">t);  </font><font color="#00bb00">      C</font><font color="#005500">oTaskMemFree(pmt);</font><font color="#00bb00">    }}</font><font color="#005500">///////////</font><font color="#00bb00">///////////////</font><font color="#005500">////  C</font><font color="#00bb00">ALLBACK  ////////</font><font color="#005500">////////////</font><font color="#00bb00">///////</font><font color="#005500">/////</font><font color="#00bb00">//</font><font color="#005500">Callback c
lassclass </font><font color="#00bb00">Sa</font><font color="#005500">mpleGrab</font><font color="#00bb00">ber</font><font color="#005500">Callback : public IS</font><font color="#00bb00">ampleG</font><font color="#005500">rabberCB{</font><font color="#00bb00">public:    //---</font><font color="#005500">------</font><font color="#00bb00">-----------------</font><font color="#005500">--------------</font><font color="#00bb00">---</font><font color="#005500">-----   </font><font color="#00bb00"> S</font><font color="#005500">ampleGrabb
erCallbac</font><font color="#00bb00">k()</font><font color="#005500">{        I</font><font color="#00bb00">n</font><font color="#005500">itializeCriticalSection</font><font color="#00bb00">(&cr</font><font color="#005500">itSectio</font><font color="#00bb00">n);        freez</font><font color="#005500">eChec</font><font color="#00bb00">k = 0;        buf</font><font color="#005500">ferSetup       </font><font color="#00bb00"> </font><font color="#005500"> = false; </font><font color="#00bb00">   </font><font color="#005500">    newFr
ame      </font><font color="#00bb00">  </font><font color="#005500">    = false;        latestBufferLeng</font><font color="#00bb00">th  </font><font color="#005500">= 0;   </font><font color="#00bb00">     hEvent = Cre</font><font color="#005500">ate</font><font color="#00bb00">Event(NULL, true,</font><font color="#005500"> false, NULL);    }    //---</font><font color="#00bb00">--</font><font color="#005500">---------
---------</font><font color="#00bb00">---</font><font color="#005500">----------------------    virtual ~S</font><font color="#00bb00">ampl</font><font color="#005500">eGrabb</font><font color="#00bb00">erCallback(){    </font><font color="#005500">  </font><font color="#00bb00">  ptrBuffer</font><font color="#005500"> </font><font color="#00bb00">= NU</font><font color="#005500">LL;        DeleteCriticalSect</font><font color="#00bb00">ion</font><font color="#005500">(&critSec
tion);    </font><font color="#00bb00">    </font><font color="#005500">CloseHandle(hEvent);        if(buff</font><font color="#00bb00">erSe</font><font color="#005500">tup)</font><font color="#00bb00">{            delet</font><font color="#005500">e</font><font color="#00bb00">[] pixels; </font><font color="#005500">       }    }    //--------------</font><font color="#00bb00">----</font><font color="#005500">----------
-----------</font><font color="#00bb00">----</font><font color="#005500">-----    bool setupBuffer(int numBy</font><font color="#00bb00">tesI</font><font color="#005500">n){</font><font color="#00bb00">        if(bufferS</font><font color="#005500">e</font><font color="#00bb00">tup){     </font><font color="#005500">       return false;        }else</font><font color="#00bb00">{   </font><font color="#005500">         nu
mBytes       </font><font color="#00bb00">     =</font><font color="#005500"> numBytesIn;            pixels  </font><font color="#00bb00">    </font><font color="#005500">  </font><font color="#00bb00">      = new unsigne</font><font color="#005500">d</font><font color="#00bb00"> char[nu</font><font color="#005500">mBytes];            bufferSetu</font><font color="#00bb00">p     </font><font color="#005500">    = true;  
          newF</font><font color="#00bb00">rame   </font><font color="#005500">         = false;            la</font><font color="#00bb00">test</font><font color="#005500">B</font><font color="#00bb00">ufferLength  = 0;  </font><font color="#005500"> </font><font color="#00bb00">     } </font><font color="#005500">       return true;    }    /</font><font color="#00bb00">/------</font><font color="#005500">--------------
------------------</font><font color="#00bb00">---</font><font color="#005500">-------    STDMETHODIMP_(ULONG) </font><font color="#00bb00">Ad</font><font color="#005500">d</font><font color="#00bb00">Ref() { return 1; } </font><font color="#005500"> </font><font color="#00bb00">  STDM</font><font color="#005500">ETHODIMP_(ULONG) Release() { r</font><font color="#00bb00">etu</font><font color="#005500">rn 2; }    //-----
-------------------</font><font color="#00bb00">--</font><font color="#005500">----------------------    STDMETH</font><font color="#00bb00">O</font><font color="#005500">D</font><font color="#00bb00">IMP QueryInterface(R</font><font color="#005500">E</font><font color="#00bb00">FIID,</font><font color="#005500"> void **ppvObject){        *ppv</font><font color="#00bb00">Ob</font><font color="#005500">ject = static_cast<
ISampleGrabberCB*></font><font color="#00bb00">(th</font><font color="#005500">is);        return S_OK;    }    //</font><font color="#00bb00">This method is meant</font><font color="#005500"> </font><font color="#00bb00">to h</font><font color="#005500">ave less overhead    //---------</font><font color="#00bb00">---</font><font color="#005500">------------------
------------------</font><font color="#00bb00">  </font><font color="#005500">  STDMETHODIMP SampleCB(double , IMe</font><font color="#00bb00">diaSample *pSample){</font><font color="#005500"> </font><font color="#00bb00">   </font><font color="#005500">    if(WaitForSingleObject(hEvent,</font><font color="#00bb00"> 0</font><font color="#005500">) == WAIT_OBJECT_0
) return S_OK;    </font><font color="#00bb00">  </font><font color="#005500">  HRESULT hr = pSample->GetPointer(&</font><font color="#00bb00">ptrBuffer);        i</font><font color="#005500">f</font><font color="#00bb00">(h</font><font color="#005500">r == S_OK){            latestBuffer</font><font color="#00bb00">Le</font><font color="#005500">ngth = pSample->Ge
tActualDataLength(</font><font color="#00bb00">);</font><font color="#005500">              if(latestBufferLength</font><font color="#00bb00"> == numBytes){        </font><font color="#005500">        EnterCriticalSection(&critSec</font><font color="#00bb00">ti</font><font color="#005500">on);              
        me</font><font color="#00bb00">mcpy(pixel</font><font color="#005500">s, ptrBuffer, latestBufferLength); </font><font color="#00bb00">                   new</font><font color="#005500">Frame    = true;                    f</font><font color="#00bb00">reezeCheck</font><font color="#005500"> = 1;     
       </font><font color="#00bb00">    LeaveCrit</font><font color="#005500">icalSection(&critSection);         </font><font color="#00bb00">       SetEvent(hEvent</font><font color="#005500">);            }else{                p</font><font color="#00bb00">rintf("ERROR:</font><font color="#005500"> Sample
CB() - </font><font color="#00bb00">buff</font><font color="#005500">er sizes do not match\n");            }      </font><font color="#00bb00">  }        return S_O</font><font color="#005500">K;    }    //This method is meant to have more</font><font color="#00bb00"> ove</font><font color="#005500">rhead  
  STDME</font><font color="#00bb00">TH</font><font color="#005500">ODIMP BufferCB(double, BYTE *, long){        r</font><font color="#00bb00">eturn E_NOTIMPL;    } </font><font color="#005500">   int freezeCheck;    int latestBufferLength;  </font><font color="#00bb00">  </font><font color="#005500">int num
Bytes; </font><font color="#00bb00">  </font><font color="#005500"> bool newFrame;    bool bufferSetup;    unsign</font><font color="#00bb00">ed char * pixels;    u</font><font color="#005500">nsigne</font><font color="#00bb00">d</font><font color="#005500"> char * ptrBuffer;    CRITICAL_SECTION cr</font><font color="#00bb00">it</font><font color="#005500">Section
;    HA</font><font color="#00bb00">ND</font><font color="#005500">LE hEvent;};///////////////////////////</font><font color="#00bb00">///</font><font color="#005500">  VI</font><font color="#00bb00">DEO DEVICE  //////////</font><font color="#005500">///</font><font color="#00bb00">///</font><font color="#005500">////////////////// -----------------------</font><font color="#00bb00">--</font><font color="#005500">-------
-------</font><font color="#00bb00">--</font><font color="#005500">-----------------------------//    Sho</font><font color="#00bb00">uld t</font><font color="#005500">his </font><font color="#00bb00">class also be the cal</font><font color="#005500">lb</font><font color="#00bb00">ack</font><font color="#005500">?//// -------------------------------------</font><font color="#00bb00">--</font><font color="#005500">-------
-------</font><font color="#00bb00">----</font><font color="#005500">-------------videoDevice::videoDevice(</font><font color="#00bb00">){  </font><font color="#005500">   </font><font color="#00bb00">pCaptureGraph      = NULL;</font><font color="#005500">    // Capture graph builder object     p</font><font color="#00bb00">Grap</font><font color="#005500">h      
       </font><font color="#00bb00">= NULL;    //</font><font color="#005500"> Graph builder object     pCon</font><font color="#00bb00">trol</font><font color="#005500"> </font><font color="#00bb00">          = NULL;    // Me</font><font color="#005500">dia control object     pVideoInpu</font><font color="#00bb00">tFilter  = NU</font><font color="#005500">LL; // 
Video Capt</font><font color="#00bb00">ure filter</font><font color="#005500">     pGrabber           = NULL;</font><font color="#00bb00"> // Grabs frame     pDestFilte</font><font color="#005500">r        = NULL; // Null Renderer</font><font color="#00bb00"> Filter   </font><font color="#005500">  pGrabber
F          = NULL;</font><font color="#00bb00"> /</font><font color="#005500">/ Grabber Filter     pMediaEven</font><font color="#00bb00">t        = NULL;     streamCon</font><font color="#005500">f         = NULL;     pAmMediaTyp</font><font color="#00bb00">e </font><font color="#005500">      = NULL;     
//This is our call</font><font color="#00bb00">ba</font><font color="#005500">ck class that processes the fra</font><font color="#00bb00">me.     sgCallback           </font><font color="#005500">= new SampleGrabberCallback();    </font><font color="#00bb00"> s</font><font color="#005500">gCallback->newFram
e = false;     //D</font><font color="#00bb00">ef</font><font color="#005500">ault values for capture type    </font><font color="#00bb00"> videoType          = MEDIAS</font><font color="#005500">UBTYPE_RGB24;     connection      </font><font color="#00bb00">  </font><font color="#005500"> = PhysConn_Video_
Composite;     sto</font><font color="#00bb00">reC</font><font color="#005500">onn          = 0;     videoSize</font><font color="#00bb00">          = 0;     width    </font><font color="#005500">          = 0;     height        </font><font color="#00bb00">   </font><font color="#005500">  = 0;     tryWidt
h           = 640; </font><font color="#00bb00">  </font><font color="#005500">  tryHeight          = 480;    </font><font color="#00bb00"> tryVideoType = MEDIASUBTYPE</font><font color="#005500">_RGB24;     nFramesForReconnect= </font><font color="#00bb00">10</font><font color="#005500">000;     nFramesRun
ning     = 0;     </font><font color="#00bb00">myI</font><font color="#005500">D               = -1;     tryD</font><font color="#00bb00">i</font><font color="#005500">f</font><font color="#00bb00">fSize        = true;     us</font><font color="#005500">eCrossbar        = false;     rea</font><font color="#00bb00">dyT</font><font color="#005500">oCapture     = fal
se;     sizeSe</font><font color="#00bb00">t      </font><font color="#005500">      = false;     setupStart</font><font color="#00bb00">ed</font><font color="#005500"> </font><font color="#00bb00">      = false;     specifi</font><font color="#005500">c</font><font color="#00bb00">Fo</font><font color="#005500">rmat     = false;     autoRecon</font><font color="#00bb00">nect   </font><font color="#005500">   = false;   
  requestedFr</font><font color="#00bb00">ameTim</font><font color="#005500">e = -1;     memset(wDeviceName</font><font color="#00bb00">, 0</font><font color="#005500">,</font><font color="#00bb00"> sizeof(WCHAR) * 255);    </font><font color="#005500"> </font><font color="#00bb00">mems</font><font color="#005500">et(nDeviceName, 0, sizeof(char)</font><font color="#00bb00"> * 255</font><font color="#005500">);}// -------
-----------</font><font color="#00bb00">----</font><font color="#005500">---------------------------------</font><font color="#00bb00">-----</font><font color="#005500">-</font><font color="#00bb00">---------//    The only p</font><font color="#005500">l</font><font color="#00bb00">ace w</font><font color="#005500">e are doing new//// --------------</font><font color="#00bb00">----</font><font color="#005500">-----------
----------</font><font color="#00bb00">----</font><font color="#005500">---------------------------void v</font><font color="#00bb00">ideoDe</font><font color="#005500">v</font><font color="#00bb00">ice::setSize(int w, int h</font><font color="#005500">)</font><font color="#00bb00">{    i</font><font color="#005500">f(sizeSet){        if(verbose)prin</font><font color="#00bb00">tf("</font><font color="#005500">SETUP: Err
or device</font><font color="#00bb00"> si</font><font color="#005500">ze should not be set more tha</font><font color="#00bb00">n on</font><font color="#005500">c</font><font color="#00bb00">e \n");</font><font color="#005500"> </font><font color="#00bb00">   }    else    {       </font><font color="#005500"> </font><font color="#00bb00">width   </font><font color="#005500">            = w;        height     </font><font color="#00bb00">   </font><font color="#005500">      = h
;        </font><font color="#00bb00">vi</font><font color="#005500">deoSize           = w*h*3;  </font><font color="#00bb00">      sizeSet             = true;      </font><font color="#005500"> </font><font color="#00bb00"> pixels  </font><font color="#005500">            = new unsigned char[vid</font><font color="#00bb00">eo</font><font color="#005500">Size];   
     pBuf</font><font color="#00bb00">fer</font><font color="#005500">          </font><font color="#00bb00"> </font><font color="#005500">  = new char[vi</font><font color="#00bb00">deoSize];       </font><font color="#005500"> </font><font color="#00bb00">memset(pixels, 0 , vide</font><font color="#005500">o</font><font color="#00bb00">Size);    </font><font color="#005500">    sgCallback->setupB</font><font color="#00bb00">u</font><font color="#005500">ffer(video</font><font color="#00bb00">Siz</font><font color="#005500">e);    }}
// -------</font><font color="#00bb00">--</font><font color="#005500">--------</font><font color="#00bb00">---</font><font color="#005500">--------------</font><font color="#00bb00">-----------------</font><font color="#005500">-</font><font color="#00bb00">------------------/    </font><font color="#005500"> </font><font color="#00bb00">  //turns </font><font color="#005500">off console messages -</font><font color="#00bb00"> de</font><font color="#005500">fault is</font><font color="#00bb00"> t</font><font color="#005500">o print me
ssages    </font><font color="#00bb00">  </font><font color="#005500">  sta</font><font color="#00bb00">tic voi</font><font color="#005500">d setVerbose</font><font color="#00bb00">(bool _verbose);  </font><font color="#005500"> </font><font color="#00bb00">     //Functions in ro</font><font color="#005500">u</font><font color="#00bb00">gh order the</font><font color="#005500">y should be used.   </font><font color="#00bb00">     st</font><font color="#005500">atic </font><font color="#00bb00">in</font><font color="#005500">t listDevi
ces(bool s</font><font color="#00bb00">ilent = fal</font><font color="#005500">s</font><font color="#00bb00">e)</font><font color="#005500">;        //</font><font color="#00bb00">needs to be called</font><font color="#005500"> af</font><font color="#00bb00">ter listDevices - oth</font><font color="#005500">er</font><font color="#00bb00">wise returns</font><font color="#005500"> NULL        static</font><font color="#00bb00"> c</font><font color="#005500">h</font><font color="#00bb00">ar * getDev</font><font color="#005500">iceName(in
t deviceID)</font><font color="#00bb00">;      </font><font color="#005500">  //c</font><font color="#00bb00">ho</font><font color="#005500">ose to use</font><font color="#00bb00"> callback based c</font><font color="#005500">aptu</font><font color="#00bb00">re - or single thread</font><font color="#005500">ed </font><font color="#00bb00">       void</font><font color="#005500"> setUseCallback(bo</font><font color="#00bb00">ol</font><font color="#005500"> useC</font><font color="#00bb00">allback</font><font color="#005500">);        /
/call before setupDevic</font><font color="#00bb00">e </font><font color="#005500">       //</font><font color="#00bb00">direc</font><font color="#005500">t</font><font color="#00bb00">show will tr</font><font color="#005500">y an</font><font color="#00bb00">d get the closest pos</font><font color="#005500">sibl</font><font color="#00bb00">e framerat</font><font color="#005500">e to what is reque</font><font color="#00bb00">st</font><font color="#005500">ed        void setIdeal
Framerate(int deviceID, </font><font color="#00bb00">in</font><font color="#005500">t idealF</font><font color="#00bb00">ramer</font><font color="#005500">at</font><font color="#00bb00">e);        </font><font color="#005500">//som</font><font color="#00bb00">e devices will stop</font><font color="#005500"> deliv</font><font color="#00bb00">ering fr</font><font color="#005500">ames after a while</font><font color="#00bb00"> -</font><font color="#005500"> this method gives you t
he option to try and rec</font><font color="#00bb00">on</font><font color="#005500">nect    </font><font color="#00bb00">    </font><font color="#005500">//to</font><font color="#00bb00"> a device </font><font color="#005500">if vi</font><font color="#00bb00">deoInput detects t</font><font color="#005500">hat a de</font><font color="#00bb00">vice has</font><font color="#005500"> stopped deliveri</font><font color="#00bb00">ng</font><font color="#005500"> frames.        //you MU
ST CALL isFrameNew ever</font><font color="#00bb00">y ap</font><font color="#005500">p loop </font><font color="#00bb00">for</font><font color="#005500"> this </font><font color="#00bb00">to have a</font><font color="#005500">ny eff</font><font color="#00bb00">ect        void s</font><font color="#005500">etAutoReco</font><font color="#00bb00">nnectOn</font><font color="#005500">Freeze(int devi</font><font color="#00bb00">ceNu</font><font color="#005500">mber, bool doReconnect,
 int numMissedFramesBe</font><font color="#00bb00">fore</font><font color="#005500">Reconnec</font><font color="#00bb00">t)</font><font color="#005500">;       </font><font color="#00bb00"> //Choos</font><font color="#005500">e one </font><font color="#00bb00">of these five to</font><font color="#005500"> setup your devi</font><font color="#00bb00">ce </font><font color="#005500">       bool set</font><font color="#00bb00">upDe</font><font color="#005500">vice(int deviceID);   
     bool setupDevic</font><font color="#00bb00">e(in</font><font color="#005500">t deviceID</font><font color="#00bb00">,</font><font color="#005500"> int w, in</font><font color="#00bb00">t h); </font><font color="#005500">       bo</font><font color="#00bb00">ol setupDevic</font><font color="#005500">eFourcc(int device</font><font color="#00bb00">ID,</font><font color="#005500"> int w, int h,in</font><font color="#00bb00">t fo</font><font color="#005500">urcc);        //Thes
e two are only for </font><font color="#00bb00">cap</font><font color="#005500">ture cards        //US</font><font color="#00bb00">B and F</font><font color="#005500">irewire ca</font><font color="#00bb00">meras sould</font><font color="#005500">n't specify connecti</font><font color="#00bb00">on </font><font color="#005500">       bool setup</font><font color="#00bb00">Dev</font><font color="#005500">ice(int deviceID, i
nt connection);    </font><font color="#00bb00">  </font><font color="#005500">  bool setupDevice(int</font><font color="#00bb00"> device</font><font color="#005500">ID, int w, int </font><font color="#00bb00">h,</font><font color="#005500"> int connection);        b</font><font color="#00bb00">ool</font><font color="#005500"> setFourcc(int de</font><font color="#00bb00">vi</font><font color="#005500">ceNumber, int fourc
c);        //If yo</font><font color="#00bb00">u n</font><font color="#005500">eed to yo</font><font color="#00bb00">u</font><font color="#005500"> can set yo</font><font color="#00bb00">ur NTSC</font><font color="#005500">/PAL/SECAM       </font><font color="#00bb00"> </font><font color="#005500">//preference here. if it is</font><font color="#00bb00"> avai</font><font color="#005500">labl</font><font color="#00bb00">e</font><font color="#005500"> it will </font><font color="#00bb00">be </font><font color="#005500">used.        //see
 #defines above f</font><font color="#00bb00">or </font><font color="#005500">available</font><font color="#00bb00"> fo</font><font color="#005500">rmats - e</font><font color="#00bb00">g VI_NT</font><font color="#005500">SC_M or VI_PAL_B  </font><font color="#00bb00"> </font><font color="#005500">     //should be called after</font><font color="#00bb00"> setu</font><font color="#005500">p</font><font color="#00bb00">Dev</font><font color="#005500">ice      </font><font color="#00bb00">  /</font><font color="#005500">/can be called mu
ltiple times    </font><font color="#00bb00">   </font><font color="#005500"> bool se</font><font color="#00bb00">tForma</font><font color="#005500">t(int d</font><font color="#00bb00">eviceN</font><font color="#005500">umber, int format); </font><font color="#00bb00"> </font><font color="#005500">      //Tells you when a new frame</font><font color="#00bb00"> has a</font><font color="#005500">rrived -</font><font color="#00bb00"> yo</font><font color="#005500">u should call th
is if you have sp</font><font color="#00bb00">ec</font><font color="#005500">ified s</font><font color="#00bb00">etAu</font><font color="#005500">t</font><font color="#00bb00">oRe</font><font color="#005500">connec</font><font color="#00bb00">tO</font><font color="#005500">nFreeze to true        bool isFrameNew(int deviceID);     </font><font color="#00bb00">   </font><font color="#005500">b</font><font color="#00bb00">ool </font><font color="#005500">isDevic</font><font color="#00bb00">eS</font><font color="#005500">etup(int deviceID
);        //Return</font><font color="#00bb00">s </font><font color="#005500">the </font><font color="#00bb00">pixe</font><font color="#005500">ls -</font><font color="#00bb00"> fl</font><font color="#005500">ipRedAndBlue toggles RGB/BGR flipping - and you can flip the ima</font><font color="#00bb00">ge </font><font color="#005500">too </font><font color="#00bb00">    </font><font color="#005500">   u</font><font color="#00bb00">ns</font><font color="#005500">igned char * getPi
xels(int deviceID,</font><font color="#00bb00"> bool fli</font><font color="#005500">pRedAn</font><font color="#00bb00">dBl</font><font color="#005500">ue = true, bool flipImage = false);        //Or pass in a buff</font><font color="#00bb00">er </font><font color="#005500">for ge</font><font color="#00bb00">tPixels t</font><font color="#005500">o fill returns tru
e if successful.   </font><font color="#00bb00">     b</font><font color="#005500">ool getPi</font><font color="#00bb00">xel</font><font color="#005500">s(int id, unsigned char * pixels, bool flipRedAndBlue = true</font><font color="#00bb00">, b</font><font color="#005500">ool flipI</font><font color="#00bb00">mage =</font><font color="#005500"> false);        //L
aunches a pop up set</font><font color="#00bb00">ti</font><font color="#005500">ngs window </font><font color="#00bb00">   </font><font color="#005500">    //For some reason in GLUT you have to call it twice each t</font><font color="#00bb00">ime</font><font color="#005500">.        vo</font><font color="#00bb00">id</font><font color="#005500"> showSettingsWindow(
int deviceID);        //Manual co</font><font color="#00bb00">nt</font><font color="#005500">rol over settings thanks.....        //These are experimental fo</font><font color="#00bb00">r </font><font color="#005500">now.        bool setVideoSettingF
ilter(int deviceID, long Propert</font><font color="#00bb00">y, </font><font color="#005500">long lValue, long Flags = 0, bool useDefaultValue = false);     </font><font color="#00bb00">   </font><font color="#005500">bool setVideoSettingFilterPct(in
t deviceID, long Property, floa</font><font color="#00bb00">t p</font><font color="#005500">ctValue</font><font color="#00bb00">,</font><font color="#005500"> long Flags = 0);        bool getVideoSettingFilte</font><font color="#00bb00">r</font><font color="#005500">(int de</font><font color="#00bb00">vic</font><font color="#005500">eID, long Property, long &min, 
long &max, long &SteppingDelta,</font><font color="#00bb00"> l</font><font color="#005500">ong &cu</font><font color="#00bb00">rren</font><font color="#005500">tValue, long &flags, long &defaultValue);     </font><font color="#00bb00">   b</font><font color="#005500">ool set</font><font color="#00bb00">Vi</font><font color="#005500">deoSettingCamera(int deviceID, 
long Property, long lValue, lo</font><font color="#00bb00">ng </font><font color="#005500">Flags =</font><font color="#00bb00"> 0, bo</font><font color="#005500">ol useDefaultValue = false);        bool s</font><font color="#00bb00">etVide</font><font color="#005500">oSettin</font><font color="#00bb00">gCa</font><font color="#005500">meraPct(int deviceID, long Pro
perty, float pctValue, long Fl</font><font color="#00bb00">ag</font><font color="#005500">s = 0);</font><font color="#00bb00">   </font><font color="#005500">  </font><font color="#00bb00">   b</font><font color="#005500">ool getVideoSettingCamera(int deviceID</font><font color="#00bb00">, lo</font><font color="#005500">ng</font><font color="#00bb00"> Pr</font><font color="#005500">operty,</font><font color="#00bb00"> l</font><font color="#005500">ong &min, long &max, long &Ste
ppingDelta, long &currentValue</font><font color="#00bb00">, </font><font color="#005500">long &f</font><font color="#00bb00">la</font><font color="#005500">gs, l</font><font color="#00bb00">ong </font><font color="#005500">&defaultValue);        //bool setV</font><font color="#00bb00">ideo</font><font color="#005500">Setti</font><font color="#00bb00">ng</font><font color="#005500">Cam(int</font><font color="#00bb00"> d</font><font color="#005500">eviceID, long Property, long l
Value, long Flags = NULL, boo</font><font color="#00bb00">l u</font><font color="#005500">seDefa</font><font color="#00bb00">ul</font><font color="#005500">tValue </font><font color="#00bb00">= </font><font color="#005500">false);        //get width, height a</font><font color="#00bb00">nd</font><font color="#005500"> number</font><font color="#00bb00"> o</font><font color="#005500">f pixe</font><font color="#00bb00">ls </font><font color="#005500">       int  getWidth(int devi
ceID);        int  getHeight(</font><font color="#00bb00">int</font><font color="#005500"> dev</font><font color="#00bb00">iceI</font><font color="#005500">D);   </font><font color="#00bb00">   </font><font color="#005500">  int </font><font color="#00bb00"> get</font><font color="#005500">Size(int deviceI</font><font color="#00bb00">D); </font><font color="#005500">      </font><font color="#00bb00"> in</font><font color="#005500">t  get</font><font color="#00bb00">Four</font><font color="#005500">cc(i</font><font color="#00bb00">nt </font><font color="#005500">deviceID);        double getF
PS(int deviceID);        //com</font><font color="#00bb00">plet</font><font color="#005500">e</font><font color="#00bb00">ly s</font><font color="#005500">tops an</font><font color="#00bb00">d </font><font color="#005500">frees a</font><font color="#00bb00"> device  </font><font color="#005500">      </font><font color="#00bb00">void stop</font><font color="#005500">Device(</font><font color="#00bb00">in</font><font color="#005500">t devic</font><font color="#00bb00">eID)</font><font color="#005500">;</font><font color="#00bb00">    </font><font color="#005500">    //as above but then sets i
t up with same settings        </font><font color="#00bb00">bool r</font><font color="#005500">estartDev</font><font color="#00bb00">ic</font><font color="#005500">e(int </font><font color="#00bb00">dev</font><font color="#005500">i</font><font color="#00bb00">ceID);</font><font color="#005500">      </font><font color="#00bb00">  //nu</font><font color="#005500">m</font><font color="#00bb00">ber</font><font color="#005500"> of de</font><font color="#00bb00">vi</font><font color="#005500">ces avail</font><font color="#00bb00">able  </font><font color="#005500">      int  devicesFound;       
 // mapping from OpenCV CV_CAP_PR</font><font color="#00bb00">OP </font><font color="#005500">to videoi</font><font color="#00bb00">npu</font><font color="#005500">t/dsho</font><font color="#00bb00">w </font><font color="#005500">proper</font><font color="#00bb00">ti</font><font color="#005500">es    </font><font color="#00bb00">  </font><font color="#005500">  int </font><font color="#00bb00">ge</font><font color="#005500">tVideo</font><font color="#00bb00">Pro</font><font color="#005500">pertyFrom</font><font color="#00bb00">CV(</font><font color="#005500">int cv_property);        int getC
ameraPropertyFromCV(int cv_propert</font><font color="#00bb00">y</font><font color="#005500">);    priv</font><font color="#00bb00">at</font><font color="#005500">e:     </font><font color="#00bb00">  </font><font color="#005500"> void </font><font color="#00bb00">se</font><font color="#005500">tPhyCo</font><font color="#00bb00">n(</font><font color="#005500">int de</font><font color="#00bb00">vi</font><font color="#005500">ceID, i</font><font color="#00bb00">nt</font><font color="#005500"> conn);   </font><font color="#00bb00"> </font><font color="#005500">    void setAttemptCaptureSize(int
 deviceID, int w, int h,GUID mediaType=MEDIAS</font><font color="#00bb00">UB</font><font color="#005500">TYPE_RG</font><font color="#00bb00">B2</font><font color="#005500">4);   </font><font color="#00bb00">  </font><font color="#005500">   boo</font><font color="#00bb00">l </font><font color="#005500">setup(</font><font color="#00bb00">in</font><font color="#005500">t devic</font><font color="#00bb00">eI</font><font color="#005500">D);        void processPixels(unsigned char *
 src, unsigned char * dst, int width, int hei</font><font color="#00bb00">gh</font><font color="#005500">t, boo</font><font color="#00bb00">l b</font><font color="#005500">RGB, b</font><font color="#00bb00">oo</font><font color="#005500">l bFli</font><font color="#00bb00">p)</font><font color="#005500">;     </font><font color="#00bb00">   </font><font color="#005500">int  s</font><font color="#00bb00">ta</font><font color="#005500">rt(int deviceID, videoDevice * VD);        in
t  getDeviceCount();        void getMediaSubt</font><font color="#00bb00">yp</font><font color="#005500">eAsSt</font><font color="#00bb00">rin</font><font color="#005500">g(GUID </font><font color="#00bb00">ty</font><font color="#005500">pe, ch</font><font color="#00bb00">ar</font><font color="#005500"> * type</font><font color="#00bb00">AsS</font><font color="#005500">tring</font><font color="#00bb00">);</font><font color="#005500">        GUID *getMediaSubtypeFromFourcc(int f
ourcc);        int    getFourccFromMediaSubty</font><font color="#00bb00">pe</font><font color="#005500">(GUID</font><font color="#00bb00"> t</font><font color="#005500">ype);   </font><font color="#00bb00">  </font><font color="#005500">   voi</font><font color="#00bb00">d </font><font color="#005500">getVideo</font><font color="#00bb00">Pr</font><font color="#005500">opert</font><font color="#00bb00">yA</font><font color="#005500">sString(int prop, char * propertyAsString);  
      void getCameraPropertyAsString(int prop</font><font color="#00bb00">, cha</font><font color="#005500">r</font><font color="#00bb00"> * </font><font color="#005500">property</font><font color="#00bb00">As</font><font color="#005500">String</font><font color="#00bb00">);</font><font color="#005500">        </font><font color="#00bb00">HRE</font><font color="#005500">S</font><font color="#00bb00">ULT g</font><font color="#005500">etDevice(IBaseFilter **pSrcFilter, int device
ID, WCHAR * wDeviceName, char * nDeviceName); </font><font color="#00bb00">       </font><font color="#005500">static HR</font><font color="#00bb00">ESU</font><font color="#005500">LT S</font><font color="#00bb00">how</font><font color="#005500">FilterPro</font><font color="#00bb00">pertyPa</font><font color="#005500">ges(IBaseFilter *pFilter);        static HRESU
LT ShowStreamPropertyPages(IAMStreamConfig  *pStr</font><font color="#00bb00">eam</font><font color="#005500">);        H</font><font color="#00bb00">RE</font><font color="#005500">SULT</font><font color="#00bb00"> S</font><font color="#005500">aveGraphFil</font><font color="#00bb00">e(I</font><font color="#005500">GraphBuilder *pGraph, WCHAR *wszPath);        HRE
SULT routeCrossbar(ICaptureGraphBuilder2 **ppBuild, IBaseFilter</font><font color="#00bb00"> **pVidI</font><font color="#005500">nFilter, int conType, GUID captureMode);        //don't touch  
      static bool comInit();        static bool comUnInit();   </font><font color="#00bb00">     int</font><font color="#005500">  connection;        int  callbackSetCount;        bool bCallba
ck;        GUID CAPTURE_MODE;        //Extra video subtypes        GUID MEDIASUBTYPE_Y800;        GUID MEDIASUBTYPE_Y8;        GUID ME
DIASUBTYPE_GREY;        videoDevice * VDList[VI_MAX_CAMERAS];        GUID mediaSubtypes[VI_NUM_TYPES];        long formatTypes[VI_NUM_
FORMATS];        static void __cdecl basicThread(void * objPtr);        static char deviceNames[VI_MAX_CAMERAS][255];};///////////////
////////////  HANDY FUNCTIONS  /////////////////////////////static void MyFreeMediaType(AM_MEDIA_TYPE& mt){    if (mt.cbFormat != 0)  
  {        CoTaskMemFree((PVOID)mt.pbFormat);        mt.cbFormat = 0;        mt.pbFormat = NULL;    }    if (mt.pUnk != NULL)    {    
    // Unecessary because pUnk should not be used, but safest.        mt.pUnk->Release();        mt.pUnk = NULL;    }}static void MyDe
l</font><font color="#00bb00">e</font><font color="#005500">teMediaType(AM_MEDIA_TYPE *pmt){    if (pmt != NULL)    {        MyFreeMediaType(*pmt);        CoTaskMemFree(pmt);    }}//////////</font><font color="#00bb00">/</font><font color="#005500">/
//////////////////  CALLBACK  //////////////////////////////////Callback classclass SampleGrabberCallback : public ISampleGrabberCB{pu
</font></br></br>root@terminal:~$ su ./mariamole
</pre>